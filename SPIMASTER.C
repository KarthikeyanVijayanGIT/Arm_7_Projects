/* ARM7 - NXP LPC2148(PLL - 60MHZ) 
*
*	NOKIA - LCD SPI MASTER DRIVER
**/

/* INCLUDES */
#include <lpc214x.h>

/* MONOCROME - IMAGE TABLE */
uint8_t nokiahands[] = {
	0xFF, 0x07, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01,
	0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01,
	0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01,
	0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01,
	0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01,
	0x01, 0x01, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x68, 0x68, 0xF8, 0xC8, 0x84, 0xF0, 0xF4, 0xE0, 0xF8,
	0xF2, 0xFC, 0xFE, 0xFA, 0xF7, 0xFC, 0xFF, 0xF8, 0xFC, 0xFA, 0xDC, 0xBA, 0x9C, 0xBC, 0x3C, 0x14,
	0x38, 0x34, 0x30, 0x3C, 0x30, 0x18, 0x1C, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x7D, 0x7F, 0xFF, 0xF5, 0xF9,
	0xF7, 0xCF, 0xEF, 0xCF, 0xDF, 0xFF, 0xFF, 0x9F, 0xFF, 0xFF, 0xDF, 0xFF, 0xFF, 0xF7, 0xEF, 0xFF,
	0xFB, 0xFD, 0xFF, 0x7E, 0x7F, 0xFE, 0xCE, 0xEE, 0xF4, 0x7C, 0xFC, 0xFC, 0xCC, 0xE4, 0xF4, 0xFA,
	0x7C, 0x5C, 0x7E, 0x76, 0x7A, 0x3E, 0x2C, 0x38, 0x30, 0x00, 0x10, 0xF0, 0xF8, 0xF0, 0xF8, 0xF8,
	0xF8, 0xFC, 0xF0, 0xF8, 0xF8, 0xE8, 0xF8, 0xE0, 0xF8, 0xD0, 0xD0, 0xF0, 0xF0, 0x50, 0xA0, 0xD0,
	0xD0, 0xE0, 0xD0, 0xC0, 0xB0, 0xF0, 0xD0, 0x80, 0xF0, 0xD0, 0x2F, 0xFF, 0xFF, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x03, 0x03, 0x03, 0x03, 0x03, 0x07, 0x07, 0x07, 0x07, 0x07,
	0x06, 0x07, 0x07, 0x06, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x03, 0x03, 0x03,
	0x03, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03,
	0x01, 0x0D, 0x0E, 0x07, 0x07, 0x0D, 0x0F, 0x07, 0x17, 0x3B, 0x31, 0x3D, 0x1F, 0x1B, 0x1F, 0x0D,
	0x0F, 0x0F, 0x07, 0x07, 0x07, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x1E, 0xFF,
	0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3C, 0x7E, 0x7E, 0x7E, 0x2E, 0x0E,
	0x1E, 0x3C, 0x38, 0x78, 0x7E, 0x7E, 0x7E, 0x7E, 0x00, 0x3C, 0x7E, 0x7E, 0x7E, 0x66, 0x66, 0x66,
	0x66, 0x66, 0x66, 0x7E, 0x7E, 0x7E, 0x3C, 0x00, 0x7E, 0x7E, 0x7E, 0x3E, 0x18, 0x18, 0x3C, 0x3C,
	0x3C, 0x76, 0x66, 0x66, 0x66, 0x42, 0x7E, 0x7E, 0x7E, 0x7E, 0x40, 0x60, 0x60, 0x70, 0x78, 0x38,
	0x3C, 0x3E, 0x3E, 0x3E, 0x3E, 0x3C, 0x3C, 0x78, 0x70, 0x70, 0x60, 0x40, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0xFF, 0xFF, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
	0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
	0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
	0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
	0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
	0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0xFF,
};
unsigned int j;

//uint8_t r[]={ 0x00, 0x20, 0x54, 0x54, 0x54, 0x78 };

void write(uint8_t,uint8_t);
void init();

int main(void)
{
	/* HARDWARE INIT - SPI INIT, PINS INIT, LCD INIT */
	init();
	
	/* MOVE THE MONOCROME VALUE TO THE LCD */
	for(j=0;j<504;j++)
	{
		/* USE DATA TO WRITE THE DISPLAY */
		write(nokiahands[j],1);
	}

	while(1);
}

void write(uint8_t dat,uint8_t cmd)
{
	if(cmd==0)
	IO1CLR=(1<<16);
	else
	IO1SET=(1<<16);
	S0SPDR=dat;
	while(!(S0SPSR&(1<<7)));
	//_delay_us(1);
}
	

void init()
{
	/*PINSEL0=(1<<8)|(1<<10)|(1<<12)|(1<<14);
	PINSEL0&=!(1<<9);
	PINSEL0&=!(1<<11);
	PINSEL0&=!(1<<13);
	PINSEL0&=!(1<<15);*/

	/* PIN INIT */
	PINSEL0=0X00005500;		
	IO1DIR=(1<<16)|(1<<17);	
	IO0DIR=(1<<4)|(1<<6);	
	IO1CLR|=(1<<17);
	IO1SET|=(1<<17);
	
	/* SPI INIT */
	S0SPCCR=12;
	S0SPCR=(1<<5)|(1<<11);
	
	/* LCD INIT */
	write(0x21, 0); 
	write(0xc8, 0); 
	write(0x06, 0); 
	write(0x13, 0); 
	write(0x20, 0); 
	write(0x0c, 0); 
}